<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>GATO ROBOT STUDY</title>
<style>
html,body{
  margin:0;
  background:#000;
  color:#eee;
  font-family: monospace;
}
canvas{
  display:block;
  margin:0 auto;
  background:#000;
}
#hint{
  text-align:center;
  font-size:12px;
  color:#777;
  margin-top:4px;
}
</style>
</head>
<body>

<canvas id="game" width="640" height="360"></canvas>
<div id="hint">← → 移動 / Z ジャンプ / X スーツ切替</div>

<script>
const c = document.getElementById("game");
const ctx = c.getContext("2d");

const GRAVITY = 0.6;
const TILE = 32;

const map = [
"####################",
"#..................#",
"#..............S...#",
"#......####........#",
"#..................#",
"#..N...............#",
"#......######......#",
"#..................#",
"#..............G...#",
"####################"
];

const player = {
  x:64, y:64,
  vx:0, vy:0,
  w:18, h:18,
  onGround:false,
  suit:true
};

const keys = {};

window.addEventListener("keydown",e=>keys[e.key]=true);
window.addEventListener("keyup",e=>keys[e.key]=false);

function solidAt(x,y){
  const tx = Math.floor(x/TILE);
  const ty = Math.floor(y/TILE);
  if(ty<0||ty>=map.length||tx<0||tx>=map[0].length) return true;
  return map[ty][tx]==="#" ||
         (map[ty][tx]==="S" && !player.suit) ||
         (map[ty][tx]==="N" && player.suit);
}

function update(){
  // 移動
  if(keys["ArrowLeft"]) player.vx = -2;
  else if(keys["ArrowRight"]) player.vx = 2;
  else player.vx *= 0.6;

  // ジャンプ
  if(keys["z"] && player.onGround){
    player.vy = -9;
    player.onGround = false;
  }

  // スーツ切替
  if(keys["x"]){
    player.suit = !player.suit;
    keys["x"]=false;
  }

  player.vy += GRAVITY;

  // X移動
  player.x += player.vx;
  if(
    solidAt(player.x, player.y) ||
    solidAt(player.x+player.w, player.y) ||
    solidAt(player.x, player.y+player.h) ||
    solidAt(player.x+player.w, player.y+player.h)
  ){
    player.x -= player.vx;
    player.vx = 0;
  }

  // Y移動
  player.y += player.vy;
  if(
    solidAt(player.x, player.y+player.h) ||
    solidAt(player.x+player.w, player.y+player.h)
  ){
    player.y = Math.floor((player.y+player.h)/TILE)*TILE - player.h;
    player.vy = 0;
    player.onGround = true;
  }
}

function draw(){
  ctx.clearRect(0,0,c.width,c.height);

  // マップ
  for(let y=0;y<map.length;y++){
    for(let x=0;x<map[y].length;x++){
      const t = map[y][x];
      if(t==="#"){
        ctx.fillStyle="#555";
        ctx.fillRect(x*TILE,y*TILE,TILE,TILE);
      }
      if(t==="S"){
        ctx.fillStyle="#888";
        ctx.fillRect(x*TILE+8,y*TILE+8,16,16);
      }
      if(t==="N"){
        ctx.strokeStyle="#aaa";
        ctx.strokeRect(x*TILE+6,y*TILE+6,20,20);
      }
      if(t==="G"){
        ctx.fillStyle="#eee";
        ctx.beginPath();
        ctx.arc(x*TILE+16,y*TILE+16,8,0,Math.PI*2);
        ctx.fill();
      }
    }
  }

  // プレイヤー
  if(player.suit){
    ctx.fillStyle="#aaa";
    ctx.fillRect(player.x,player.y,player.w,player.h);
  }else{
    ctx.fillStyle="#eee";
    ctx.beginPath();
    ctx.arc(player.x+9,player.y+9,9,0,Math.PI*2);
    ctx.fill();
  }
}

function loop(){
  update();
  draw();
  requestAnimationFrame(loop);
}

loop();
</script>

</body>
</html>

